backport the fix from #66164 to fix #65703. use OrderedDict to fix bad indexing.
