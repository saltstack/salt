refactored server-side PKI to support cache interface
